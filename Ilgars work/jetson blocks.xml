<blocks app="Snap! 7, https://snap.berkeley.edu" version="2"><palette><category name="Jetson" color="4,77,0,1"/></palette><block-definition s="save costume %&apos;costume&apos;" type="command" category="Jetson"><comment x="0" y="0" w="90" collapsed="false">Saves costume as a PNG&#xD;&#xD;By pumpkinhead</comment><header></header><code></code><translations></translations><inputs><input type="%s" readonly="true"><options>ยง_costumesMenu</options></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>costume</l></list><l>if (!(costume instanceof Costume)) throw new Error("Not a Costume");&#xD;&#xD;var data = costume.contents.toDataURL("image/png");&#xD;&#xD;var link = document.createElement("a");&#xD;link.download = costume.name + ".png";&#xD;link.href = data;&#xD;link.click();</l></block><list><block s="reportIfElse"><block s="reportIsA"><block var="costume"/><l><option>costume</option></l></block><block var="costume"/><block s="reportFindFirst"><block s="reifyPredicate"><autolambda><block s="reportEquals"><block s="reportGetImageAttribute"><l><option>name</option></l><l></l></block><block var="costume"/></block></autolambda><list></list></block><block s="reportGet"><l><option>costumes</option></l></block></block></block></list></block></script></block-definition><block-definition s="costume from Jetson %&apos;response&apos;" type="reporter" category="Jetson"><header></header><code></code><translations></translations><inputs><input type="%txt"></input></inputs><script><block s="doDeclareVariables"><list><l>costume</l><l>url</l></list></block><block s="doSetVar"><l>url</l><block s="reportListItem"><l>2</l><block s="reportListItem"><l>2</l><block var="response"/></block></block></block><block s="doSetVar"><l>costume</l><block s="evaluate"><block s="reportJSFunction"><list><l>url</l></list><l>var img = new Image(),&#xD;cst = false;&#xD;img.crossOrigin = &apos;anonymous&apos;;&#xD;img.onload = () =&gt; cst = new Costume(img);&#xD;img.src = &apos;data:image/png;base64,&apos; + url;&#xD;return () =&gt; cst;</l></block><list><block var="url"/></list></block></block><block s="doWaitUntil"><block s="evaluate"><block var="costume"/><list></list></block></block><block s="doReport"><block s="evaluate"><block var="costume"/><list></list></block></block></script><scripts><comment x="455.19140625" y="33.866666666666674" w="90" collapsed="false">Credit to @jens</comment></scripts></block-definition><block-definition s="response objects from Jetson %&apos;jetson&apos; %&apos;object&apos;" type="reporter" category="Jetson"><header></header><code></code><translations></translations><inputs><input type="%s"></input><input type="%s"></input></inputs><script><block s="doDeclareVariables"><list><l>base64</l></list></block><block s="doDeclareVariables"><list><l>objects</l></list></block><block s="doDeclareVariables"><list><l>result</l></list></block><block s="doSetVar"><l>base64</l><block s="evaluate"><block s="reportJSFunction"><list><l>object</l></list><l>return object.contents.toDataURL();</l></block><list><block var="object"/></list></block></block><block s="doRun"><block s="reportJSFunction"><list><l>base64</l><l>socket</l></list><l>socket.send(String(base64));</l></block><list><block var="base64"/><block var="jetson"/></list></block><block s="doSetVar"><l>objects</l><block s="reportListItem"><l>2</l><block s="reportListItem"><l>1</l><block s="reportTextSplit"><block s="evaluate"><block s="reportJSFunction"><list><l>socket</l></list><l>return socket.response;</l></block><list><block var="jetson"/></list></block><l><option>json</option></l></block></block></block></block><block s="doReport"><block var="objects"/></block></script><scripts><script x="709.2373046875" y="334.49999999999994"><block var="result"/></script></scripts></block-definition><block-definition s="connect to Jetson url %&apos;url&apos;" type="reporter" category="Jetson"><header></header><code></code><translations></translations><inputs><input type="%s">ws://192.168.137.53:4040</input></inputs><script><block s="doReport"><block s="evaluate"><block s="reportJSFunction"><list><l>url</l></list><l>const socket = new WebSocket(url);&#xD;&#xD;socket.addEventListener(&apos;open&apos;, function (event) {&#xD;    //socket.send(&apos;Hello Jetson, Snap! here&apos;);&#xD;});&#xD;&#xD;socket.addEventListener(&apos;message&apos;, function (event) {&#xD;    socket.response = event.data;&#xD;    // console.log(&apos;Message from server &apos;, event.data);&#xD;});&#xD;return socket;</l></block><list><block var="url"/></list></block></block></script></block-definition><block-definition s="detect from jetson %&apos;jetson&apos; %&apos;frame&apos;" type="command" category="Jetson"><header></header><code></code><translations></translations><inputs><input type="%s"></input><input type="%s"></input></inputs><script><block s="doUntil"><block s="reportKeyPressed"><l><option>e</option></l></block><script><block s="doSetVar"><l>i</l><l>1</l></block><block s="doSetVar"><l>objects</l><custom-block s="response objects from Jetson %s %s"><block var="jetson"/><block var="frame"/></custom-block></block><block s="doForEach"><l>item</l><block var="objects"/><script><block s="createClone"><l><option>myself</option></l></block></script></block><block s="doWait"><l>0.1</l></block></script></block></script></block-definition><block-definition s="draw detections" type="command" category="Jetson"><header></header><code></code><translations></translations><inputs></inputs><script><block s="hide"></block><block s="doDeclareVariables"><list><l>index</l><l>object</l></list></block><block s="doSetVar"><l>object</l><block s="reportNewList"><list></list></block></block><block s="doSetVar"><l>index</l><block var="i"/></block><block s="doChangeVar"><l>i</l><l>1</l></block><block s="doSetVar"><l>object</l><block s="reportListItem"><block var="index"/><block var="objects"/></block></block><block s="doSetVar"><l>debug</l><block s="reportListItem"><l>4</l><block var="object"/></block></block><block s="doDeclareVariables"><list><l>Top</l><l>Bottom</l><l>Left</l><l>Right</l></list></block><block s="doSetVar"><l>Top</l><block s="reportListItem"><l>3</l><block var="object"/></block></block><block s="doSetVar"><l>Bottom</l><block s="reportListItem"><l>4</l><block var="object"/></block></block><block s="doSetVar"><l>Left</l><block s="reportListItem"><l>5</l><block var="object"/></block></block><block s="doSetVar"><l>Right</l><block s="reportListItem"><l>6</l><block var="object"/></block></block><block s="doRun"><block s="reifyScript"><script><block s="setXPosition"><block var="#1"/></block><block s="setYPosition"><block var="#2"/></block><block s="down"></block><block s="setSize"><l>5</l></block><block s="setColor"><color>95,229,0,1</color></block><block s="doFor"><l>i</l><l>1</l><l>2</l><script><block s="forward"><block var="#3"/></block><block s="turn"><l>90</l></block><block s="forward"><block var="#4"/></block><block s="turn"><l>90</l></block></script></block><block s="up"></block><block s="turn"><l>45</l></block><block s="forward"><l>10</l></block><block s="setPenColorDimension"><l><option>transparency</option></l><l>70</l></block><block s="turn"><l>45</l></block><block s="forward"><l>20</l></block><block s="turnLeft"><l>90</l></block><block s="setPenColorDimension"><l><option>transparency</option></l><l>0</l></block><block s="setColor"><color>24,255,6,1</color></block><block s="write"><block s="reportJoinWords"><list><block s="reportListItem"><l>1</l><block var="object"/></block><l> </l><block s="reportRound"><block s="reportVariadicProduct"><list><l>100</l><block s="reportListItem"><l>2</l><block var="object"/></block></list></block></block><l>%</l></list></block><l>24</l></block><block s="doAddToList"><block s="reportPenTrailsAsCostume"></block><block s="reportGet"><l><option>costumes</option></l></block></block><block s="clear"></block><block s="setScale"><l>100</l></block><block s="doSwitchToCostume"><block s="reportListItem"><l>1</l><block s="reportGet"><l><option>costumes</option></l></block></block></block></script><list><l>#1</l><l>#2</l><l>#3</l><l>#4</l></list></block><list><block s="reportVariadicSum"><list><block s="reportQuotient"><block s="reportAttributeOf"><l><option>width</option></l><l>Stage</l></block><l>-2</l></block><block var="Left"/></list></block><block s="reportDifference"><block s="reportQuotient"><block s="reportAttributeOf"><l><option>height</option></l><l>Stage</l></block><l>2</l></block><block var="Top"/></block><block s="reportDifference"><block var="Right"/><block var="Left"/></block><block s="reportDifference"><block var="Bottom"/><block var="Top"/></block></list></block><block s="show"></block><block s="doWait"><l>0.1</l></block><block s="removeClone"></block></script></block-definition><block-definition s="response objects from Jetson %&apos;jetson&apos; %&apos;base64&apos; image" type="reporter" category="Jetson"><header></header><code></code><translations></translations><inputs><input type="%s"></input><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>base64</l><l>socket</l></list><l>socket.send(base64);</l></block><list><block var="base64"/><block var="jetson"/></list></block><block s="doReport"><block s="reportListItem"><l>2</l><block s="reportListItem"><l>2</l><block s="reportTextSplit"><block s="evaluate"><block s="reportJSFunction"><list><l>socket</l></list><l>return socket.response;</l></block><list><block var="jetson"/></list></block><l><option>json</option></l></block></block></block></block></script></block-definition></blocks>